/* Write your T-SQL query statement below */
WITH User_info AS(
SELECT TOP 1 u.name results
    FROM movierating mr 
    JOIN users u ON u.user_id = mr.user_id 
    GROUP BY u.name
    ORDER BY count(mr.movie_id) desc, u.name asc),

rating AS(
SELECT TOP 1 title results
    from movierating mr 
    JOIN Movies m on m.movie_id = mr.movie_id
    WHERE FORMAT(created_at, 'yyyy-MM') = '2020-02'
    group by title
    ORDER BY AVG(rating  * 1.0) desc, title asc
)


SELECT results FROM User_info
UNION ALL
SELECT results FROM rating

