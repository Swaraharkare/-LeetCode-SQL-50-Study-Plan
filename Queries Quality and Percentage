/* Write your T-SQL query statement below */


SELECT  DISTINCT query_name,
ROUND(AVG(CAST(rating AS DECIMAL(10,2))/position),2) AS quality,
ROUND(COUNT(case when rating<3 then 1 else NULL end)*100.00/COUNT(*), 2) as poor_query_percentage 
FROM Queries 
GROUP BY query_name;
