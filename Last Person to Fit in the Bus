/* Write your T-SQL query statement below */

SELECT TOP 1 Q.person_name AS person_name
FROM Queue Q
INNER JOIN 
(SELECT turn,person_id,person_name,weight,
SUM(weight) OVER(ORDER BY turn) AS total_weight
FROM Queue) T
ON Q.person_id=T.person_id
WHERE total_weight<=1000
ORDER BY total_weight DESC;
